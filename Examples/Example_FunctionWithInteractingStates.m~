clear global ; clear; close all;

% Example function with interacting states...
%-------------
f  = @(x) ( sum(toeplitz(x)) )' ;

x  = 2:12; % actual optimsed values to find
y  = f(x); % data given correct parameters

rng default;

x0 = randn(size(x));     % random start positions
V  = ones(size(x0))/512; % variances/step sizes

op = AO('options');  % this returns the optimiser input options structure
op.step_method = 1;  % aggressive steps = 1, careful = 3, vanilla = 4.
op.fun = f;          % function/model
op.x0  = x0(:);      % start values
op.y   = y(:);       % data we're fitting (for computation of objective fun)
op.V   = V(:);       % corresponding vars/step sizes for each param (x0)

op.step_method = 3;   % aggressive steps = 1, careful = 3, vanilla = 4.
op.maxit       = 128; % maximum number of iterations

[X,F,CV] = AO(op);

% Compare data with prediction
[f(x) f(X)]